我来为您详细介绍如何搭建本地VSCode + CMake + MSVC开发环境。

## 1. 安装必要软件

### 1.1 安装 Visual Studio (MSVC)
```bash
# 下载 Visual Studio Community 免费版
# 安装时选择 "使用C++的桌面开发" 工作负载
# 确保包含 MSVC 编译器和 Windows SDK
```

### 1.2 安装 VSCode
```bash
# 从官网下载并安装 VSCode
# https://code.visualstudio.com/
```

### 1.3 安装 CMake
```bash
# 从官网下载 CMake
# https://cmake.org/download/
# 安装时选择 "Add CMake to the system PATH"
```

## 2. 安装 VSCode 扩展

在 VSCode 中安装以下扩展：
- **C/C++** (Microsoft)
- **CMake** (twxs)
- **CMake Tools** (Microsoft)

## 3. 项目结构示例

创建项目目录结构：
```
my_project/
├── CMakeLists.txt
├── src/
│   ├── main.cpp
│   └── math_utils.cpp
├── include/
│   └── math_utils.h
└── build/
```

## 4. 创建示例文件

### 4.1 CMakeLists.txt
```cmake
cmake_minimum_required(VERSION 3.15)
project(MyProject VERSION 1.0.0 LANGUAGES CXX)

# 设置 C++ 标准
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

# 包含目录
include_directories(include)

# 添加可执行文件
add_executable(${PROJECT_NAME}
    src/main.cpp
    src/math_utils.cpp
)

# 设置编译器选项（MSVC特定）
if(MSVC)
    target_compile_options(${PROJECT_NAME} PRIVATE /W4)
endif()
```

### 4.2 include/math_utils.h
```cpp
#pragma once

namespace math_utils {
    int add(int a, int b);
    double multiply(double a, double b);
}
```

### 4.3 src/math_utils.cpp
```cpp
#include "math_utils.h"

namespace math_utils {
    int add(int a, int b) {
        return a + b;
    }
    
    double multiply(double a, double b) {
        return a * b;
    }
}
```

### 4.4 src/main.cpp
```cpp
#include <iostream>
#include "math_utils.h"

int main() {
    std::cout << "Hello from MSVC + CMake + VSCode!" << std::endl;
    std::cout << "5 + 3 = " << math_utils::add(5, 3) << std::endl;
    std::cout << "4.5 * 2.0 = " << math_utils::multiply(4.5, 2.0) << std::endl;
    return 0;
}
```

<!-- ## 5. 配置 VSCode

### 5.1 创建工作区设置
创建 `.vscode/settings.json`：
```json
{
    "cmake.generator": "Visual Studio 17 2022",
    "cmake.buildDirectory": "${workspaceFolder}/build",
    "cmake.configureSettings": {
        "CMAKE_BUILD_TYPE": "Debug"
    },
    "files.associations": {
        "*.cpp": "cpp",
        "*.h": "cpp"
    },
    "C_Cpp.default.configurationProvider": "ms-vscode.cmake-tools"
}
```

### 5.2 配置调试设置
创建 `.vscode/launch.json`：
```json
{
    "version": "0.2.0",
    "configurations": [
        {
            "name": "CMake Debug",
            "type": "cppvsdbg",
            "request": "launch",
            "program": "${command:cmake.launchTargetPath}",
            "args": [],
            "stopAtEntry": false,
            "cwd": "${workspaceFolder}",
            "environment": [],
            "console": "integratedTerminal",
            "preLaunchTask": "cmake: build"
        }
    ]
}
``` -->

## 6. 构建和运行

### 方法1：使用 VSCode CMake Tools
1. 打开命令面板 (Ctrl+Shift+P)
2. 输入 "CMake: Configure"
3. 选择 MSVC 编译器
4. 输入 "CMake: Build" 构建项目
5. 按 F5 调试运行

### 方法2：命令行构建
```cmd
# 在项目根目录执行
mkdir build
cd build
cmake -G "Visual Studio 17 2022" ..
cmake --build . --config Debug
# 运行程序
./Debug/MyProject.exe
```
