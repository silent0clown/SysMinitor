<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>报告分析 - OS Monitor Pro</title>
    <link rel="stylesheet" href="assets/css/tailwind.min.css">
    <script src="assets/js/anime.min.js"></script>
    <script src="assets/js/echarts.min.js"></script>
    <link href="assets/css/fonts.css" rel="stylesheet">
 
    <style>
        body { font-family: 'Noto Sans SC', sans-serif; }
        .glass-card { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.2); }
        .health-score { 
            background: conic-gradient(from 0deg, #ef4444 0deg, #fbbf24 120deg, #22c55e 240deg, #22c55e 360deg);
            border-radius: 50%;
            position: relative;
        }
        .health-score::before {
            content: '';
            position: absolute;
            top: 10px;
            left: 10px;
            right: 10px;
            bottom: 10px;
            background: white;
            border-radius: 50%;
        }
        .score-excellent { color: #059669; }
        .score-good { color: #84cc16; }
        .score-fair { color: #d97706; }
        .score-poor { color: #dc2626; }
        .check-item { transition: all 0.3s ease; }
        .check-item:hover { transform: translateX(4px); }
        .progress-ring { transform: rotate(-90deg); }
        .recommendation-card { transition: all 0.3s ease; }
        .recommendation-card:hover { transform: translateY(-2px); box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
        .scan-animation { animation: scan 2s ease-in-out infinite; }
        @keyframes scan {
            0%, 100% { transform: translateY(0); opacity: 0.5; }
            50% { transform: translateY(-10px); opacity: 1; }
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">
    <!-- 顶部导航栏 -->
    <nav class="bg-white shadow-sm border-b border-gray-200 sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center space-x-4">
                    <div class="flex items-center space-x-2">
                        <div class="w-8 h-8 bg-gradient-to-br from-blue-500 to-teal-600 rounded-lg flex items-center justify-center">
                            <span class="text-white font-bold text-sm">OS</span>
                        </div>
                        <h1 class="text-xl font-bold text-gray-900">Monitor Pro</h1>
                    </div>
                </div>
                
                <div class="flex items-center space-x-3">
                    <button id="quickCheckBtn" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg font-medium transition-colors">
                        快速检查
                    </button>
                    <button id="fullScanBtn" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg font-medium transition-colors">
                        全面扫描
                    </button>
                    <button id="exportReportBtn" class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg font-medium transition-colors">
                        导出报告
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <div class="flex">
        <!-- 左侧边栏 -->
        <div class="w-64 bg-white shadow-sm min-h-screen">
            <div class="p-6">
                <nav class="space-y-2">
                    <a href="index.html" class="flex items-center space-x-3 px-4 py-3 text-gray-600 hover:bg-gray-50 rounded-lg transition-colors">
                        <span>📊</span>
                        <span>实时仪表盘</span>
                    </a>
                    <a href="snapshot.html" class="flex items-center space-x-3 px-4 py-3 text-gray-600 hover:bg-gray-50 rounded-lg transition-colors">
                        <span>📸</span>
                        <span>快照管理</span>
                    </a>
                    <a href="report.html" class="flex items-center space-x-3 px-4 py-3 bg-blue-50 text-blue-700 rounded-lg font-medium">
                        <span class="text-blue-600">📋</span>
                        <span>报告分析</span>
                    </a>
                    <a href="settings.html" class="flex items-center space-x-3 px-4 py-3 text-gray-600 hover:bg-gray-50 rounded-lg transition-colors">
                        <span>⚙️</span>
                        <span>设置</span>
                    </a>
                </nav>
            </div>

            <!-- 快速统计 -->
            <div class="p-6 border-t border-gray-200">
                <h3 class="text-sm font-semibold text-gray-500 uppercase tracking-wider mb-3">检查统计</h3>
                <div class="space-y-3">
                    <div class="flex justify-between items-center">
                        <span class="text-sm text-gray-600">总检查次数:</span>
                        <span class="font-medium text-blue-600">156</span>
                    </div>
                    <div class="flex justify-between items-center">
                        <span class="text-sm text-gray-600">问题发现:</span>
                        <span class="font-medium text-red-600">23</span>
                    </div>
                    <div class="flex justify-between items-center">
                        <span class="text-sm text-gray-600">已修复:</span>
                        <span class="font-medium text-green-600">18</span>
                    </div>
                    <div class="flex justify-between items-center">
                        <span class="text-sm text-gray-600">平均得分:</span>
                        <span class="font-medium text-yellow-600">78</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- 主内容区 -->
        <div class="flex-1 p-6">
            <!-- 健康得分概览 -->
            <div class="mb-8">
                <div class="glass-card rounded-xl p-8">
                    <div class="text-center mb-8">
                        <h2 class="text-3xl font-bold text-gray-900 mb-4">系统健康检查</h2>
                        <p class="text-gray-600">全面评估您的系统健康状况，发现问题并提供优化建议</p>
                    </div>

                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 items-center">
                        <!-- 健康得分圆环 -->
                        <div class="text-center">
                            <div class="relative inline-block">
                                <div class="health-score w-48 h-48 flex items-center justify-center">
                                    <div class="relative z-10 text-center">
                                        <div id="healthScore" class="text-4xl font-bold score-fair">72</div>
                                        <div class="text-sm text-gray-600">健康得分</div>
                                    </div>
                                </div>
                                <svg class="absolute inset-0 w-48 h-48">
                                    <circle cx="96" cy="96" r="88" stroke="#e5e7eb" stroke-width="8" fill="none"/>
                                    <circle id="scoreProgress" cx="96" cy="96" r="88" stroke="#d97706" stroke-width="8" 
                                            fill="none" stroke-linecap="round" 
                                            stroke-dasharray="552.92" stroke-dashoffset="154.82"/>
                                </svg>
                            </div>
                            <div class="mt-4">
                                <div id="scoreStatus" class="text-lg font-medium score-fair">需要关注</div>
                                <div class="text-sm text-gray-600">建议进行系统优化</div>
                            </div>
                        </div>

                        <!-- 检查项目状态 -->
                        <div class="space-y-4">
                            <h3 class="text-lg font-semibold text-gray-900 mb-4">检查项目</h3>
                            <div class="space-y-3" id="checkItems">
                                <!-- 检查项目将通过JavaScript动态生成 -->
                            </div>
                        </div>

                        <!-- 快速操作 -->
                        <div class="space-y-4">
                            <h3 class="text-lg font-semibold text-gray-900 mb-4">快速操作</h3>
                            <div class="space-y-3">
                                <button class="w-full bg-green-500 hover:bg-green-600 text-white px-4 py-3 rounded-lg font-medium transition-colors text-left">
                                    🔧 一键优化系统
                                </button>
                                <button class="w-full bg-blue-500 hover:bg-blue-600 text-white px-4 py-3 rounded-lg font-medium transition-colors text-left">
                                    🧹 清理垃圾文件
                                </button>
                                <button class="w-full bg-yellow-500 hover:bg-yellow-600 text-white px-4 py-3 rounded-lg font-medium transition-colors text-left">
                                    🔄 更新驱动程序
                                </button>
                                <button class="w-full bg-purple-500 hover:bg-purple-600 text-white px-4 py-3 rounded-lg font-medium transition-colors text-left">
                                    🔒 加强系统安全
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 详细检查报告 -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                <!-- 性能分析 -->
                <div class="glass-card rounded-xl p-6">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-xl font-semibold text-gray-900">性能分析</h3>
                        <span class="text-sm text-gray-500">最近24小时</span>
                    </div>
                    <div class="h-64" id="performanceChart"></div>
                </div>

                <!-- 资源使用趋势 -->
                <div class="glass-card rounded-xl p-6">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-xl font-semibold text-gray-900">资源使用趋势</h3>
                        <div class="flex space-x-2">
                            <button class="text-sm px-3 py-1 bg-blue-100 text-blue-700 rounded-lg">1天</button>
                            <button class="text-sm px-3 py-1 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors">7天</button>
                            <button class="text-sm px-3 py-1 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors">30天</button>
                        </div>
                    </div>
                    <div class="h-64" id="resourceChart"></div>
                </div>
            </div>

            <!-- 问题和建议 -->
            <div class="mb-8">
                <div class="glass-card rounded-xl p-6">
                    <h3 class="text-xl font-semibold text-gray-900 mb-6">问题诊断与建议</h3>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6" id="recommendationsList">
                        <!-- 建议卡片将通过JavaScript动态生成 -->
                    </div>
                </div>
            </div>

            <!-- 历史报告 -->
            <div class="mb-8">
                <div class="glass-card rounded-xl p-6">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-xl font-semibold text-gray-900">历史检查报告</h3>
                        <button class="text-blue-600 hover:text-blue-800 font-medium">查看全部</button>
                    </div>
                    
                    <div class="space-y-4" id="historyReports">
                        <!-- 历史报告将通过JavaScript动态生成 -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 检查进度模态框 -->
    <div id="checkProgressModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center">
        <div class="bg-white rounded-xl p-8 max-w-md w-full mx-4">
            <div class="text-center">
                <div class="w-20 h-20 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-6 scan-animation">
                    <span class="text-3xl">🔍</span>
                </div>
                <h3 class="text-xl font-semibold mb-2" id="checkTitle">系统健康检查</h3>
                <p class="text-gray-600 mb-6" id="checkDescription">正在分析您的系统...</p>
                
                <div class="w-full bg-gray-200 rounded-full h-3 mb-4">
                    <div id="checkProgressBar" class="bg-blue-600 h-3 rounded-full transition-all duration-300" style="width: 0%"></div>
                </div>
                
                <div id="checkStatus" class="text-sm text-gray-500 mb-6">准备开始...</div>
                
                <button id="cancelCheckBtn" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded-lg transition-colors">
                    取消检查
                </button>
            </div>
        </div>
    </div>

    <!-- 检查完成模态框 -->
    <div id="checkCompleteModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center">
        <div class="bg-white rounded-xl p-8 max-w-lg w-full mx-4">
            <div class="text-center">
                <div class="w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6">
                    <span class="text-3xl">✅</span>
                </div>
                <h3 class="text-xl font-semibold mb-4">检查完成</h3>
                
                <div class="bg-gray-50 rounded-lg p-6 mb-6">
                    <div class="text-center mb-4">
                        <div id="finalScore" class="text-4xl font-bold score-fair">72</div>
                        <div class="text-sm text-gray-600">健康得分</div>
                    </div>
                    
                    <div class="grid grid-cols-2 gap-4 text-sm">
                        <div class="text-center">
                            <div id="problemsFound" class="text-2xl font-bold text-red-600">3</div>
                            <div class="text-gray-600">发现问题</div>
                        </div>
                        <div class="text-center">
                            <div id="recommendationsCount" class="text-2xl font-bold text-blue-600">5</div>
                            <div class="text-gray-600">优化建议</div>
                        </div>
                    </div>
                </div>
                
                <div class="flex space-x-3">
                    <button id="viewDetailsBtn" class="bg-blue-500 hover:bg-blue-600 text-white px-6 py-2 rounded-lg font-medium transition-colors">
                        查看详情
                    </button>
                    <button id="closeCompleteModal" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded-lg font-medium transition-colors">
                        关闭
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // 报告分析系统
        class ReportAnalyzer {
            constructor() {
                this.healthScore = 72;
                this.checkItems = [];
                this.recommendations = [];
                this.historyReports = [];
                this.charts = {};
                this.init();
            }

            init() {
                this.generateMockData();
                this.renderCheckItems();
                this.renderRecommendations();
                this.renderHistoryReports();
                this.initCharts();
                this.bindEvents();
                this.animateHealthScore();
            }

            // 生成模拟数据
            generateMockData() {
                this.checkItems = [
                    {
                        name: 'CPU性能',
                        status: 'warning',
                        score: 65,
                        description: 'CPU使用率较高，建议关闭不必要的应用程序',
                        icon: '🖥️'
                    },
                    {
                        name: '内存使用',
                        status: 'critical',
                        score: 45,
                        description: '内存使用率过高，检测到内存泄漏',
                        icon: '💾'
                    },
                    {
                        name: '磁盘空间',
                        status: 'good',
                        score: 85,
                        description: '磁盘空间充足，系统运行正常',
                        icon: '💿'
                    },
                    {
                        name: '注册表健康',
                        status: 'warning',
                        score: 70,
                        description: '发现3处注册表异常增长',
                        icon: '📋'
                    },
                    {
                        name: '系统安全',
                        status: 'excellent',
                        score: 92,
                        description: '系统安全配置正常，防护完善',
                        icon: '🛡️'
                    },
                    {
                        name: '网络连接',
                        status: 'good',
                        score: 78,
                        description: '网络连接稳定，速度良好',
                        icon: '🌐'
                    },
                    {
                        name: '驱动程序',
                        status: 'warning',
                        score: 68,
                        description: '发现2个驱动程序需要更新',
                        icon: '🔧'
                    },
                    {
                        name: '启动项管理',
                        status: 'fair',
                        score: 58,
                        description: '启动项较多，影响开机速度',
                        icon: '🚀'
                    }
                ];

                this.recommendations = [
                    {
                        priority: 'high',
                        title: '关闭内存占用过高的进程',
                        description: 'Chrome浏览器占用1.2GB内存，建议关闭不必要的标签页以释放内存',
                        category: 'memory',
                        action: 'close_process',
                        impact: 'high',
                        icon: '🧹'
                    },
                    {
                        priority: 'high',
                        title: '清理注册表垃圾项',
                        description: '检测到15个无效的注册表项，建议清理以提升系统性能',
                        category: 'registry',
                        action: 'cleanup_registry',
                        impact: 'medium',
                        icon: '🧽'
                    },
                    {
                        priority: 'medium',
                        title: '更新显卡驱动程序',
                        description: '当前显卡驱动版本较旧，更新后可提升图形性能和稳定性',
                        category: 'driver',
                        action: 'update_driver',
                        impact: 'medium',
                        icon: '🔄'
                    },
                    {
                        priority: 'medium',
                        title: '禁用不必要的启动项',
                        description: '系统启动时有12个程序自动运行，建议禁用非必要的启动项',
                        category: 'startup',
                        action: 'manage_startup',
                        impact: 'medium',
                        icon: '⚡'
                    },
                    {
                        priority: 'low',
                        title: '清理临时文件',
                        description: '系统中有2.3GB的临时文件，定期清理可释放磁盘空间',
                        category: 'cleanup',
                        action: 'clean_temp',
                        impact: 'low',
                        icon: '🗑️'
                    },
                    {
                        priority: 'low',
                        title: '优化系统视觉效果',
                        description: '调整视觉效果设置可提升系统响应速度',
                        category: 'performance',
                        action: 'optimize_visual',
                        impact: 'low',
                        icon: '✨'
                    }
                ];

                this.historyReports = [
                    {
                        date: new Date(Date.now() - 7 * 24 * 60 * 60 * 1000),
                        score: 78,
                        problems: 2,
                        status: 'good',
                        type: 'weekly'
                    },
                    {
                        date: new Date(Date.now() - 14 * 24 * 60 * 60 * 1000),
                        score: 65,
                        problems: 4,
                        status: 'warning',
                        type: 'weekly'
                    },
                    {
                        date: new Date(Date.now() - 21 * 24 * 60 * 60 * 1000),
                        score: 82,
                        problems: 1,
                        status: 'excellent',
                        type: 'monthly'
                    },
                    {
                        date: new Date(Date.now() - 30 * 24 * 60 * 60 * 1000),
                        score: 58,
                        problems: 6,
                        status: 'critical',
                        type: 'monthly'
                    }
                ];
            }

            // 渲染检查项目
            renderCheckItems() {
                const container = document.getElementById('checkItems');
                container.innerHTML = '';

                this.checkItems.forEach(item => {
                    const statusColor = {
                        'excellent': 'text-green-600',
                        'good': 'text-green-500',
                        'fair': 'text-yellow-600',
                        'warning': 'text-orange-600',
                        'critical': 'text-red-600'
                    }[item.status];

                    const statusText = {
                        'excellent': '优秀',
                        'good': '良好',
                        'fair': '一般',
                        'warning': '警告',
                        'critical': '危险'
                    }[item.status];

                    const itemElement = document.createElement('div');
                    itemElement.className = 'check-item flex items-center justify-between p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors cursor-pointer';
                    
                    itemElement.innerHTML = `
                        <div class="flex items-center space-x-3">
                            <span class="text-lg">${item.icon}</span>
                            <div>
                                <div class="font-medium text-gray-900">${item.name}</div>
                                <div class="text-xs text-gray-500">${item.description}</div>
                            </div>
                        </div>
                        <div class="text-right">
                            <div class="font-medium ${statusColor}">${item.score}/100</div>
                            <div class="text-xs ${statusColor}">${statusText}</div>
                        </div>
                    `;

                    itemElement.addEventListener('click', () => {
                        this.showItemDetails(item);
                    });

                    container.appendChild(itemElement);
                });
            }

            // 渲染建议卡片
            renderRecommendations() {
                const container = document.getElementById('recommendationsList');
                container.innerHTML = '';

                this.recommendations.forEach(rec => {
                    const priorityColor = {
                        'high': 'border-red-200 bg-red-50',
                        'medium': 'border-yellow-200 bg-yellow-50',
                        'low': 'border-blue-200 bg-blue-50'
                    }[rec.priority];

                    const priorityText = {
                        'high': '高优先级',
                        'medium': '中优先级',
                        'low': '低优先级'
                    }[rec.priority];

                    const recElement = document.createElement('div');
                    recElement.className = `recommendation-card p-6 rounded-xl border-2 ${priorityColor}`;
                    
                    recElement.innerHTML = `
                        <div class="flex items-start space-x-4">
                            <div class="text-2xl">${rec.icon}</div>
                            <div class="flex-1">
                                <div class="flex items-center space-x-2 mb-2">
                                    <h4 class="font-semibold text-gray-900">${rec.title}</h4>
                                    <span class="px-2 py-1 text-xs rounded-full ${
                                        rec.priority === 'high' ? 'bg-red-100 text-red-800' :
                                        rec.priority === 'medium' ? 'bg-yellow-100 text-yellow-800' :
                                        'bg-blue-100 text-blue-800'
                                    }">
                                        ${priorityText}
                                    </span>
                                </div>
                                <p class="text-gray-600 text-sm mb-3">${rec.description}</p>
                                <div class="flex items-center justify-between">
                                    <span class="text-xs text-gray-500">影响程度: ${rec.impact}</span>
                                    <button class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors" onclick="reportAnalyzer.applyRecommendation('${rec.action}')">
                                        立即修复
                                    </button>
                                </div>
                            </div>
                        </div>
                    `;

                    container.appendChild(recElement);
                });
            }

            // 渲染历史报告
            renderHistoryReports() {
                const container = document.getElementById('historyReports');
                container.innerHTML = '';

                this.historyReports.forEach(report => {
                    const statusColor = {
                        'excellent': 'text-green-600',
                        'good': 'text-green-500',
                        'warning': 'text-yellow-600',
                        'critical': 'text-red-600'
                    }[report.status];

                    const statusText = {
                        'excellent': '优秀',
                        'good': '良好',
                        'warning': '警告',
                        'critical': '危险'
                    }[report.status];

                    const reportElement = document.createElement('div');
                    reportElement.className = 'flex items-center justify-between p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors cursor-pointer';
                    
                    reportElement.innerHTML = `
                        <div class="flex items-center space-x-4">
                            <div class="text-center">
                                <div class="text-lg font-bold ${statusColor}">${report.score}</div>
                                <div class="text-xs ${statusColor}">${statusText}</div>
                            </div>
                            <div>
                                <div class="font-medium text-gray-900">
                                    ${report.type === 'weekly' ? '周度检查' : '月度检查'} - ${report.date.toLocaleDateString('zh-CN')}
                                </div>
                                <div class="text-sm text-gray-600">
                                    发现问题: ${report.problems}个
                                </div>
                            </div>
                        </div>
                        <button class="text-blue-600 hover:text-blue-800 text-sm font-medium">
                            查看详情 →
                        </button>
                    `;

                    container.appendChild(reportElement);
                });
            }

            // 初始化图表
            initCharts() {
                // 性能分析图表
                this.charts.performance = echarts.init(document.getElementById('performanceChart'));
                this.charts.performance.setOption({
                    tooltip: { trigger: 'axis' },
                    legend: { data: ['CPU', '内存', '磁盘'] },
                    grid: { left: '3%', right: '4%', bottom: '3%', containLabel: true },
                    xAxis: {
                        type: 'category',
                        data: ['00:00', '04:00', '08:00', '12:00', '16:00', '20:00', '24:00']
                    },
                    yAxis: { type: 'value', axisLabel: { formatter: '{value}%' } },
                    series: [
                        {
                            name: 'CPU',
                            type: 'line',
                            smooth: true,
                            data: [45, 52, 38, 67, 73, 48, 42],
                            itemStyle: { color: '#059669' },
                            areaStyle: { color: 'rgba(5, 150, 105, 0.1)' }
                        },
                        {
                            name: '内存',
                            type: 'line',
                            smooth: true,
                            data: [78, 82, 75, 85, 88, 80, 76],
                            itemStyle: { color: '#d97706' },
                            areaStyle: { color: 'rgba(217, 119, 6, 0.1)' }
                        },
                        {
                            name: '磁盘',
                            type: 'line',
                            smooth: true,
                            data: [32, 28, 35, 45, 38, 30, 29],
                            itemStyle: { color: '#3b82f6' },
                            areaStyle: { color: 'rgba(59, 130, 246, 0.1)' }
                        }
                    ]
                });

                // 资源使用趋势图表
                this.charts.resource = echarts.init(document.getElementById('resourceChart'));
                this.charts.resource.setOption({
                    tooltip: { trigger: 'axis' },
                    legend: { data: ['可用内存', '已用磁盘'] },
                    grid: { left: '3%', right: '4%', bottom: '3%', containLabel: true },
                    xAxis: {
                        type: 'category',
                        data: ['周一', '周二', '周三', '周四', '周五', '周六', '周日']
                    },
                    yAxis: { type: 'value' },
                    series: [
                        {
                            name: '可用内存',
                            type: 'bar',
                            data: [3.2, 2.8, 3.5, 2.1, 2.9, 3.8, 4.1],
                            itemStyle: { color: '#22c55e' }
                        },
                        {
                            name: '已用磁盘',
                            type: 'bar',
                            data: [398, 402, 395, 410, 405, 390, 385],
                            itemStyle: { color: '#f59e0b' }
                        }
                    ]
                });
            }

            // 动画显示健康得分
            animateHealthScore() {
                const scoreElement = document.getElementById('healthScore');
                const progressElement = document.getElementById('scoreProgress');
                const statusElement = document.getElementById('scoreStatus');
                
                let currentScore = 0;
                const targetScore = this.healthScore;
                const circumference = 2 * Math.PI * 88; // r=88
                
                const animate = () => {
                    if (currentScore < targetScore) {
                        currentScore += 1;
                        scoreElement.textContent = currentScore;
                        
                        const offset = circumference - (currentScore / 100) * circumference;
                        progressElement.style.strokeDashoffset = offset;
                        
                        // 更新状态和颜色
                        if (currentScore >= 90) {
                            scoreElement.className = 'text-4xl font-bold score-excellent';
                            statusElement.textContent = '优秀';
                            statusElement.className = 'text-lg font-medium score-excellent';
                            progressElement.style.stroke = '#059669';
                        } else if (currentScore >= 75) {
                            scoreElement.className = 'text-4xl font-bold score-good';
                            statusElement.textContent = '良好';
                            statusElement.className = 'text-lg font-medium score-good';
                            progressElement.style.stroke = '#84cc16';
                        } else if (currentScore >= 60) {
                            scoreElement.className = 'text-4xl font-bold score-fair';
                            statusElement.textContent = '需要关注';
                            statusElement.className = 'text-lg font-medium score-fair';
                            progressElement.style.stroke = '#d97706';
                        } else {
                            scoreElement.className = 'text-4xl font-bold score-poor';
                            statusElement.textContent = '需要修复';
                            statusElement.className = 'text-lg font-medium score-poor';
                            progressElement.style.stroke = '#dc2626';
                        }
                        
                        requestAnimationFrame(animate);
                    }
                };
                
                animate();
            }

            // 显示检查项目详情
            showItemDetails(item) {
                alert(`${item.name} 详细信息\n\n得分: ${item.score}/100\n状态: ${item.status}\n\n${item.description}\n\n点击查看详细分析和修复建议。`);
            }

            // 应用建议
            applyRecommendation(action) {
                const actions = {
                    'close_process': '正在关闭高内存占用进程...',
                    'cleanup_registry': '正在清理注册表...',
                    'update_driver': '正在检查驱动程序更新...',
                    'manage_startup': '正在管理启动项...',
                    'clean_temp': '正在清理临时文件...',
                    'optimize_visual': '正在优化视觉效果...'
                };
                
                alert(`执行操作: ${actions[action] || '正在执行优化操作...'}\n\n操作完成后系统性能将得到改善。`);
            }

            // 显示检查进度
            showCheckProgress(type) {
                const modal = document.getElementById('checkProgressModal');
                const title = document.getElementById('checkTitle');
                const description = document.getElementById('checkDescription');
                const progressBar = document.getElementById('checkProgressBar');
                const status = document.getElementById('checkStatus');
                
                const checkConfig = {
                    quick: {
                        title: '快速检查',
                        description: '正在执行快速系统健康检查...',
                        steps: [
                            { progress: 20, status: '检查CPU性能...', delay: 300 },
                            { progress: 40, status: '检查内存使用...', delay: 400 },
                            { progress: 60, status: '检查磁盘状态...', delay: 300 },
                            { progress: 80, status: '检查系统安全...', delay: 400 },
                            { progress: 100, status: '检查完成！', delay: 300 }
                        ]
                    },
                    full: {
                        title: '全面扫描',
                        description: '正在执行深度系统分析和扫描...',
                        steps: [
                            { progress: 10, status: '分析CPU性能...', delay: 500 },
                            { progress: 20, status: '检测内存泄漏...', delay: 800 },
                            { progress: 30, status: '扫描磁盘错误...', delay: 600 },
                            { progress: 40, status: '检查注册表完整性...', delay: 900 },
                            { progress: 50, status: '验证系统文件...', delay: 700 },
                            { progress: 60, status: '检查驱动程序...', delay: 800 },
                            { progress: 70, status: '扫描恶意软件...', delay: 1000 },
                            { progress: 80, status: '检查网络配置...', delay: 600 },
                            { progress: 90, status: '分析启动项...', delay: 500 },
                            { progress: 100, status: '扫描完成！', delay: 400 }
                        ]
                    }
                };
                
                const config = checkConfig[type];
                title.textContent = config.title;
                description.textContent = config.description;
                modal.classList.remove('hidden');
                
                let currentStep = 0;
                const executeStep = () => {
                    if (currentStep < config.steps.length) {
                        const step = config.steps[currentStep];
                        progressBar.style.width = step.progress + '%';
                        status.textContent = step.status;
                        
                        setTimeout(() => {
                            currentStep++;
                            executeStep();
                        }, step.delay);
                    } else {
                        setTimeout(() => {
                            modal.classList.add('hidden');
                            this.showCheckComplete(type);
                        }, 1000);
                    }
                };
                
                executeStep();
            }

            // 显示检查完成
            showCheckComplete(type) {
                const modal = document.getElementById('checkCompleteModal');
                const score = document.getElementById('finalScore');
                const problems = document.getElementById('problemsFound');
                const recommendations = document.getElementById('recommendationsCount');
                
                // 生成新的检查结果
                const newScore = Math.floor(Math.random() * 30) + 60;
                const newProblems = Math.floor(Math.random() * 5) + 1;
                const newRecommendations = Math.floor(Math.random() * 5) + 3;
                
                score.textContent = newScore;
                problems.textContent = newProblems;
                recommendations.textContent = newRecommendations;
                
                // 更新健康得分
                this.healthScore = newScore;
                this.animateHealthScore();
                
                modal.classList.remove('hidden');
            }

            // 绑定事件
            bindEvents() {
                // 快速检查按钮
                document.getElementById('quickCheckBtn').addEventListener('click', () => {
                    this.showCheckProgress('quick');
                });

                // 全面扫描按钮
                document.getElementById('fullScanBtn').addEventListener('click', () => {
                    this.showCheckProgress('full');
                });

                // 导出报告按钮
                document.getElementById('exportReportBtn').addEventListener('click', () => {
                    this.exportReport();
                });

                // 取消检查按钮
                document.getElementById('cancelCheckBtn').addEventListener('click', () => {
                    document.getElementById('checkProgressModal').classList.add('hidden');
                });

                // 查看详情按钮
                document.getElementById('viewDetailsBtn').addEventListener('click', () => {
                    document.getElementById('checkCompleteModal').classList.add('hidden');
                });

                // 关闭完成模态框
                document.getElementById('closeCompleteModal').addEventListener('click', () => {
                    document.getElementById('checkCompleteModal').classList.add('hidden');
                });

                // 快速操作按钮
                document.querySelectorAll('.bg-green-500, .bg-blue-500, .bg-yellow-500, .bg-purple-500').forEach(btn => {
                    if (btn.textContent.includes('一键优化') || btn.textContent.includes('清理垃圾') || 
                        btn.textContent.includes('更新驱动') || btn.textContent.includes('加强安全')) {
                        btn.addEventListener('click', () => {
                            alert(`执行操作: ${btn.textContent.trim()}\n\n此功能将在实际应用中执行相应的系统优化操作。`);
                        });
                    }
                });
            }

            // 导出报告
            exportReport() {
                alert('报告导出功能\n\n此功能将生成包含以下内容的详细报告：\n- 系统健康得分\n- 各项检查详细结果\n- 问题诊断和建议\n- 性能趋势图表\n- 历史对比数据\n\n支持导出为PDF、HTML和Word格式。');
            }
        }

        // 初始化报告分析器
        document.addEventListener('DOMContentLoaded', () => {
            window.reportAnalyzer = new ReportAnalyzer();
            
            // 响应式图表调整
            window.addEventListener('resize', () => {
                Object.values(window.reportAnalyzer.charts).forEach(chart => {
                    chart.resize();
                });
            });
        });
    </script>
</body>
</html>