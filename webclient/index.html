<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OS Monitor Pro - ç³»ç»Ÿç›‘æ§ä»ªè¡¨ç›˜</title>
    <link rel="stylesheet" href="assets/css/tailwind.min.css">
    <script src="assets/js/anime.min.js"></script>
    <script src="assets/js/echarts.min.js"></script>
    <link href="assets/css/fonts.css" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans SC', sans-serif;
        }
        .hero-bg {
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
        }
        .glass-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .status-good {
            color: #059669;
        }
        .status-warning {
            color: #d97706;
        }
        .status-critical {
            color: #dc2626;
        }
        .pulse-animation {
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: 0.5;
            }
        }
        .chart-container {
            height: 200px;
        }
        .metric-card {
            transition: all 0.3s ease;
        }
        .metric-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        .chart-container-sm {
            width: 64px;
            height: 64px;
        }
        .disk-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 1rem;
        }
        .disk-card {
            border: 1px solid #e5e7eb;
            border-radius: 0.5rem;
            padding: 1rem;
            background-color: #f9fafb;
        }
        .performance-metric {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
        }
        .performance-value {
            font-weight: 500;
        }
        .io-high { color: #dc2626; }
        .io-medium { color: #d97706; }
        .io-low { color: #059669; }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">
    <nav class="bg-white shadow-sm border-b border-gray-200 sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center space-x-4">
                    <div class="flex items-center space-x-2">
                        <div class="w-8 h-8 bg-gradient-to-br from-blue-500 to-teal-600 rounded-lg flex items-center justify-center">
                            <span class="text-white font-bold text-sm">OS</span>
                        </div>
                        <h1 class="text-xl font-bold text-gray-900">Monitor Pro</h1>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <div class="flex">
        <div class="w-64 bg-white shadow-sm min-h-screen">
            <div class="p-6">
                <nav class="space-y-2">
                    <a href="index.html" class="flex items-center space-x-3 px-4 py-3 bg-blue-50 text-blue-700 rounded-lg font-medium">
                        <span class="text-blue-600">ğŸ“Š</span>
                        <span>å®æ—¶ä»ªè¡¨ç›˜</span>
                    </a>
                    <a href="snapshot.html" class="flex items-center space-x-3 px-4 py-3 text-gray-600 hover:bg-gray-50 rounded-lg transition-colors">
                        <span>ğŸ“¸</span>
                        <span>å¿«ç…§ç®¡ç†</span>
                    </a>
                    <a href="settings.html" class="flex items-center space-x-3 px-4 py-3 text-gray-600 hover:bg-gray-50 rounded-lg transition-colors">
                        <span>âš™ï¸</span>
                        <span>è®¾ç½®</span>
                    </a>
                </nav>
            </div>

            <div class="p-6 border-t border-gray-200">
                <h3 class="text-sm font-semibold text-gray-500 uppercase tracking-wider mb-3">ç³»ç»Ÿä¿¡æ¯</h3>
                <div class="space-y-2 text-sm">
                    <div class="flex justify-between">
                        <span class="text-gray-600">è¿è¡Œæ—¶é—´:</span>
                        <span class="font-medium" id="system-uptime">-</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="flex-1 p-6">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                <!-- CPUä¿¡æ¯å¡ç‰‡ -->
                <div class="metric-card glass-card rounded-xl p-6">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-lg font-semibold text-gray-700">CPU ä¿¡æ¯</h3>
                        <span class="status-good text-sm font-medium" id="cpu-status">è‰¯å¥½</span>
                    </div>
                    <div class="flex items-center space-x-4">
                        <div class="flex-1">
                            <div class="chart-container" id="cpu-chart"></div>
                            <div class="text-center mt-2 text-sm font-medium text-gray-700" id="cpu-name">-</div>
                        </div>
                        <div class="text-right">
                            <div class="text-sm text-gray-500 mb-1" id="cpu-vendor">å‚å•†: -</div>
                            <div class="text-sm text-gray-500 mb-1" id="cpu-architecture">æ¶æ„: -</div>
                            <div class="text-sm text-gray-500 mb-1" id="cpu-physical-cores">ç‰©ç†æ ¸å¿ƒ: -</div>
                            <div class="text-sm text-gray-500 mb-1" id="cpu-logical-cores">é€»è¾‘æ ¸å¿ƒ: -</div>
                            <div class="text-sm text-gray-500 mb-1" id="cpu-base-frequency">åŸºå‡†é¢‘ç‡: -</div>
                            <div class="text-sm text-gray-500" id="cpu-max-frequency">æœ€å¤§é¢‘ç‡: -</div>
                        </div>
                    </div>
                    <div class="mt-4 text-center">
                        <div class="text-2xl font-bold text-gray-900" id="cpu-usage">0%</div>
                        <div class="text-sm text-gray-500">å½“å‰ä½¿ç”¨ç‡</div>
                    </div>
                </div>

                <!-- å†…å­˜ä¿¡æ¯å¡ç‰‡ -->
                <div class="metric-card glass-card rounded-xl p-6">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-lg font-semibold text-gray-700">å†…å­˜ä¿¡æ¯</h3>
                        <span class="status-good text-sm font-medium" id="memory-status">è‰¯å¥½</span>
                    </div>
                    <div class="flex items-center space-x-4">
                        <div class="flex-1">
                            <div class="chart-container" id="memory-chart"></div>
                        </div>
                        <div class="text-right">
                            <div class="text-3xl font-bold text-gray-900" id="memory-usage-percent">0%</div>
                            <div class="text-sm text-gray-500" id="memory-used">0 GB</div>
                            <div class="text-sm text-gray-500" id="memory-total">0 GB</div>
                        </div>
                    </div>
                    <div class="mt-4">
                        <div class="w-full bg-gray-200 rounded-full h-2">
                            <div class="bg-blue-600 h-2 rounded-full" id="memory-progress-bar" style="width: 0%"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="grid grid-cols-1 gap-6">
                <!-- ç£ç›˜ä¿¡æ¯å¡ç‰‡ -->
                <div class="glass-card rounded-xl p-6">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-lg font-semibold text-gray-700">ç£ç›˜ä¿¡æ¯</h3>
                        <span class="status-good text-sm font-medium" id="disk-status">è‰¯å¥½</span>
                    </div>
                    <div class="overflow-y-auto max-h-screen">
                        <div class="disk-grid" id="disk-container">
                            <!-- ç£ç›˜ä¿¡æ¯å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                        </div>
                    </div>
                </div>

                <!-- è¿›ç¨‹ä¿¡æ¯å¡ç‰‡ -->
                <div class="glass-card rounded-xl p-6">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-lg font-semibold text-gray-700">è¿›ç¨‹ä¿¡æ¯</h3>
                        <div class="flex space-x-2">
                            <button class="text-sm px-3 py-1 bg-blue-100 text-blue-700 rounded-lg" onclick="filterProcesses('all')">å…¨éƒ¨</button>
                        </div>
                    </div>
                    <div class="overflow-x-auto">
                        <div class="max-h-96 overflow-y-auto">
                            <table class="min-w-full divide-y divide-gray-200">
                                <thead class="bg-gray-50 sticky top-0 z-10">
                                    <tr>
                                        <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            è¿›ç¨‹åç§°
                                        </th>
                                        <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            PID
                                        </th>
                                        <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            CPUä½¿ç”¨ç‡
                                        </th>
                                        <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            å†…å­˜ä½¿ç”¨
                                        </th>
                                        <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            çº¿ç¨‹æ•°
                                        </th>
                                    </tr>
                                </thead>
                                <tbody class="bg-white divide-y divide-gray-200" id="process-list">
                                    <!-- è¿›ç¨‹ä¿¡æ¯å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // APIå®¢æˆ·ç«¯
        class ApiClient {
            constructor() {
                this.baseURL = '';
            }

            async request(endpoint) {
                try {
                    const response = await fetch(`${this.baseURL}${endpoint}`);
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    return await response.json();
                } catch (error) {
                    console.error('APIè¯·æ±‚å¤±è´¥:', error);
                    throw error;
                }
            }

            get(endpoint) {
                return this.request(endpoint);
            }
        }

        // ç³»ç»Ÿç›‘æ§ä¸»ç±»
        class SystemMonitor {
            constructor() {
                this.apiClient = new ApiClient();
                this.charts = {};
                this.diskPerformanceData = {};
                this.init();
            }

            async init() {
                // åˆå§‹åŒ–å›¾è¡¨
                this.initCharts();
                
                // è·å–åˆå§‹æ•°æ®
                await this.fetchInitialData();
                
                // å¯åŠ¨å®æ—¶æ›´æ–°
                this.startRealTimeUpdates();
            }

            initCharts() {
                // CPUå›¾è¡¨
                this.charts.cpu = echarts.init(document.getElementById('cpu-chart'));
                this.charts.cpu.setOption({
                    series: [{
                        type: 'gauge',
                        startAngle: 90,
                        endAngle: -270,
                        pointer: { show: true },
                        progress: {
                            show: true,
                            overlap: false,
                            roundCap: true,
                            clip: false,
                            itemStyle: { borderWidth: 1, borderColor: '#fff' }
                        },
                        axisLine: { lineStyle: { width: 8 } },
                        splitLine: { show: false },
                        axisTick: { show: false },
                        axisLabel: { show: false },
                        data: [{
                            value: 0,
                            name: 'CPUä½¿ç”¨ç‡',
                            title: { offsetCenter: ['0%', '0%'] },
                            detail: { show: false },
                            itemStyle: { color: '#059669' }
                        }],
                        radius: '100%'
                    }]
                });

                // å†…å­˜å›¾è¡¨
                this.charts.memory = echarts.init(document.getElementById('memory-chart'));
                this.charts.memory.setOption({
                    series: [{
                        type: 'gauge',
                        startAngle: 90,
                        endAngle: -270,
                        pointer: { show: true },
                        progress: {
                            show: true,
                            overlap: false,
                            roundCap: true,
                            clip: false,
                            itemStyle: { borderWidth: 1, borderColor: '#fff' }
                        },
                        axisLine: { lineStyle: { width: 8 } },
                        splitLine: { show: false },
                        axisTick: { show: false },
                        axisLabel: { show: false },
                        data: [{
                            value: 0,
                            name: 'å†…å­˜ä½¿ç”¨ç‡',
                            title: { offsetCenter: ['0%', '0%'] },
                            detail: { show: false },
                            itemStyle: { color: '#3b82f6' }
                        }],
                        radius: '100%'
                    }]
                });
            }

            async fetchInitialData() {
                try {
                    // è·å–CPUä¿¡æ¯
                    const cpuInfo = await this.apiClient.get('/api/cpu/info');
                    this.updateCPUInfo(cpuInfo);

                    // è·å–ç£ç›˜ä¿¡æ¯
                    const diskInfo = await this.apiClient.get('/api/disk/info');
                    const diskPerformance = await this.apiClient.get('/api/disk/performance');
                    this.updateDiskInfo(diskInfo, diskPerformance);

                    // è·å–è¿›ç¨‹ä¿¡æ¯
                    const processes = await this.apiClient.get('/api/processes');
                    this.updateProcessList(processes);
                } catch (error) {
                    console.error('è·å–åˆå§‹æ•°æ®å¤±è´¥:', error);
                }
            }

            updateCPUInfo(cpuInfo) {
                // æ›´æ–°CPUåŸºæœ¬ä¿¡æ¯
                document.getElementById('cpu-name').textContent = cpuInfo.name || '-';
                document.getElementById('cpu-vendor').textContent = `å‚å•†: ${cpuInfo.vendor || '-'}`;
                document.getElementById('cpu-architecture').textContent = `æ¶æ„: ${cpuInfo.architecture || '-'}`;
                document.getElementById('cpu-physical-cores').textContent = `ç‰©ç†æ ¸å¿ƒ: ${cpuInfo.physicalCores || '-'}`;
                document.getElementById('cpu-logical-cores').textContent = `é€»è¾‘æ ¸å¿ƒ: ${cpuInfo.logicalCores || '-'}`;
                
                if (cpuInfo.baseFrequency) {
                    const baseFreqGHz = (cpuInfo.baseFrequency / 1000).toFixed(2);
                    document.getElementById('cpu-base-frequency').textContent = `åŸºå‡†é¢‘ç‡: ${baseFreqGHz} GHz`;
                }
                
                if (cpuInfo.maxFrequency) {
                    const maxFreqGHz = (cpuInfo.maxFrequency / 1000 / 1000 / 1000).toFixed(2);
                    document.getElementById('cpu-max-frequency').textContent = `æœ€å¤§é¢‘ç‡: ${maxFreqGHz} GHz`;
                }
            }

            updateDiskInfo(diskInfo, diskPerformance) {
                const container = document.getElementById('disk-container');
                container.innerHTML = '';

                if (!diskInfo.partitions || diskInfo.partitions.length === 0) {
                    container.innerHTML = '<div class="text-center text-gray-500 py-4">æœªæ£€æµ‹åˆ°ç£ç›˜åˆ†åŒº</div>';
                    return;
                }

                // åˆ›å»ºdriveLetteråˆ°performanceçš„æ˜ å°„
                const performanceMap = {};
                if (diskPerformance.performance) {
                    diskPerformance.performance.forEach(perf => {
                        performanceMap[perf.driveLetter] = perf;
                    });
                }

                // åˆå¹¶driveså’Œpartitionsä¿¡æ¯
                const driveMap = {};
                if (diskInfo.drives) {
                    diskInfo.drives.forEach(drive => {
                        if (drive.deviceId) {
                            driveMap[drive.deviceId] = drive;
                        }
                    });
                }

                diskInfo.partitions.forEach(partition => {
                    const usagePercent = partition.usagePercentage || 0;
                    let statusClass = 'bg-green-500';
                    if (usagePercent > 90) statusClass = 'bg-red-500';
                    else if (usagePercent > 80) statusClass = 'bg-yellow-500';

                    const performance = performanceMap[partition.driveLetter] || {};
                    
                    // è·å–å¯¹åº”é©±åŠ¨å™¨çš„è¯¦ç»†ä¿¡æ¯
                    const driveInfo = driveMap[partition.driveLetter + "\\"] || {};

                    const formatBytes = (bytes) => {
                        if (bytes === 0) return '0 Bytes';
                        const k = 1024;
                        const sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB'];
                        const i = Math.floor(Math.log(bytes) / Math.log(k));
                        return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
                    };

                    // æ ¹æ®IOé€Ÿåº¦ç¡®å®šé¢œè‰²ç±»
                    const getIOColorClass = (speed) => {
                        if (speed > 10) return 'io-high';
                        if (speed > 5) return 'io-medium';
                        return 'io-low';
                    };

                    const formatSpeed = (bytesPerSec) => {
                        if (bytesPerSec === 0) return '0 B/s';
                        const k = 1024;
                        const sizes = ['B/s', 'KB/s', 'MB/s', 'GB/s'];
                        const i = Math.floor(Math.log(bytesPerSec) / Math.log(k));
                        return parseFloat((bytesPerSec / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
                    };

                    const diskCard = document.createElement('div');
                    diskCard.className = 'disk-card';
                    diskCard.innerHTML = `
                        <div class="flex justify-between items-start mb-3">
                            <div>
                                <h4 class="font-medium text-gray-800">${partition.driveLetter || 'æœªçŸ¥'}: ç›˜</h4>
                                <div class="text-sm text-gray-500">${partition.label || 'æ— å·æ ‡'}</div>
                            </div>
                            <span class="text-sm font-medium ${usagePercent > 90 ? 'text-red-600' : usagePercent > 80 ? 'text-yellow-600' : 'text-green-600'}">
                                ${usagePercent.toFixed(1)}%
                            </span>
                        </div>
                        
                        <div class="w-full bg-gray-200 rounded-full h-2 mb-4">
                            <div class="h-2 rounded-full ${statusClass}" style="width: ${usagePercent}%"></div>
                        </div>
                        
                        <div class="grid grid-cols-2 gap-3 mb-4 text-sm">
                            <div>
                                <div class="text-gray-500">å·²ä½¿ç”¨</div>
                                <div class="font-medium">${formatBytes(partition.usedSpace || 0)}</div>
                            </div>
                            <div>
                                <div class="text-gray-500">æ€»å®¹é‡</div>
                                <div class="font-medium">${formatBytes(partition.totalSize || 0)}</div>
                            </div>
                            <div>
                                <div class="text-gray-500">æ–‡ä»¶ç³»ç»Ÿ</div>
                                <div class="font-medium">${partition.fileSystem || 'æœªçŸ¥'}</div>
                            </div>
                            <div>
                                <div class="text-gray-500">æ‰‡åŒºå¤§å°</div>
                                <div class="font-medium">${driveInfo.bytesPerSector || 'æœªçŸ¥'} Bytes</div>
                            </div>
                        </div>
                        
                        <div class="border-t border-gray-200 pt-3">
                            <h5 class="text-sm font-medium text-gray-700 mb-2">ç¡¬ä»¶ä¿¡æ¯</h5>
                            <div class="grid grid-cols-2 gap-2 text-xs">
                                <div>
                                    <div class="text-gray-500">å‹å·</div>
                                    <div class="font-medium">${driveInfo.model || 'æœªçŸ¥'}</div>
                                </div>
                                <div>
                                    <div class="text-gray-500">æ¥å£ç±»å‹</div>
                                    <div class="font-medium">${driveInfo.interfaceType || 'æœªçŸ¥'}</div>
                                </div>
                                <div>
                                    <div class="text-gray-500">å¥åº·çŠ¶æ€</div>
                                    <div class="font-medium">${driveInfo.status || 'æœªçŸ¥'}</div>
                                </div>
                                <div>
                                    <div class="text-gray-500">åºåˆ—å·</div>
                                    <div class="font-medium">${driveInfo.serialNumber || 'æ— '}</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="border-t border-gray-200 pt-3 mt-3">
                            <h5 class="text-sm font-medium text-gray-700 mb-2">æ€§èƒ½æ•°æ®</h5>
                            <div class="space-y-1 text-xs">
                                <div class="performance-metric">
                                    <span class="text-gray-500">è¯»å–é€Ÿåº¦</span>
                                    <span class="performance-value ${getIOColorClass(performance.readSpeed || 0)}">${(performance.readSpeed || 0).toFixed(2)} MB/s</span>
                                </div>
                                <div class="performance-metric">
                                    <span class="text-gray-500">å†™å…¥é€Ÿåº¦</span>
                                    <span class="performance-value ${getIOColorClass(performance.writeSpeed || 0)}">${(performance.writeSpeed || 0).toFixed(2)} MB/s</span>
                                </div>
                                <div class="performance-metric">
                                    <span class="text-gray-500">ç£ç›˜ä½¿ç”¨ç‡</span>
                                    <span class="performance-value">${(performance.usagePercentage || 0).toFixed(1)}%</span>
                                </div>
                                <div class="performance-metric">
                                    <span class="text-gray-500">å“åº”æ—¶é—´</span>
                                    <span class="performance-value">${performance.responseTime || 0} ms</span>
                                </div>
                                <div class="performance-metric">
                                    <span class="text-gray-500">è¯»å–å­—èŠ‚</span>
                                    <span class="performance-value">${formatSpeed(performance.readBytesPerSec || 0)}</span>
                                </div>
                                <div class="performance-metric">
                                    <span class="text-gray-500">å†™å…¥å­—èŠ‚</span>
                                    <span class="performance-value">${formatSpeed(performance.writeBytesPerSec || 0)}</span>
                                </div>
                            </div>
                        </div>
                    `;
                    container.appendChild(diskCard);
                });
            }

            updateProcessList(processesData) {
                const container = document.getElementById('process-list');
                container.innerHTML = '';

                if (!processesData.processes || processesData.processes.length === 0) {
                    const row = document.createElement('tr');
                    row.innerHTML = '<td colspan="5" class="px-4 py-3 text-center text-gray-500">æœªæ£€æµ‹åˆ°è¿›ç¨‹</td>';
                    container.appendChild(row);
                    return;
                }

                // æŒ‰CPUä½¿ç”¨ç‡æ’åºï¼Œæ˜¾ç¤ºå‰20ä¸ª
                const processes = processesData.processes
                    .sort((a, b) => (b.cpuUsage || 0) - (a.cpuUsage || 0))
                    .slice(0, 20);

                processes.forEach(process => {
                    const row = document.createElement('tr');
                    row.className = 'hover:bg-gray-50 transition-colors';
                    
                    // æ ¹æ®CPUä½¿ç”¨ç‡è®¾ç½®é¢œè‰²
                    let cpuColorClass = 'text-gray-900';
                    if (process.cpuUsage > 50) cpuColorClass = 'text-red-600';
                    else if (process.cpuUsage > 20) cpuColorClass = 'text-orange-600';
                    else if (process.cpuUsage > 5) cpuColorClass = 'text-yellow-600';
                    
                    // æ ¹æ®å†…å­˜ä½¿ç”¨é‡è®¾ç½®é¢œè‰²
                    let memoryColorClass = 'text-gray-900';
                    const memoryMB = (process.workingSetSize || 0) / (1024 * 1024);
                    if (memoryMB > 1000) memoryColorClass = 'text-red-600';
                    else if (memoryMB > 500) memoryColorClass = 'text-orange-600';
                    else if (memoryMB > 100) memoryColorClass = 'text-yellow-600';
                    
                    const formatMemory = (bytes) => {
                        if (bytes === 0) return '0 MB';
                        const mb = bytes / (1024 * 1024);
                        if (mb < 1) return `${Math.round(mb * 1024)} KB`;
                        return `${mb.toFixed(1)} MB`;
                    };

                    row.innerHTML = `
                        <td class="px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900">${process.name || '-'}</td>
                        <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-500">${process.pid || '-'}</td>
                        <td class="px-4 py-3 whitespace-nowrap text-sm font-medium ${cpuColorClass}">${(process.cpuUsage || 0).toFixed(1)}%</td>
                        <td class="px-4 py-3 whitespace-nowrap text-sm font-medium ${memoryColorClass}">${formatMemory(process.workingSetSize || 0)}</td>
                        <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-500">${process.threadCount || '-'}</td>
                    `;
                    container.appendChild(row);
                });
            }

            async updateRealTimeData() {
                try {
                    // æ›´æ–°CPUä½¿ç”¨ç‡
                    const cpuUsageData = await this.apiClient.get('/api/cpu/usage');
                    const cpuUsage = cpuUsageData.usage.toFixed(1) || 0;
                    document.getElementById('cpu-usage').textContent = `${cpuUsage}%`;
                    
                    // æ›´æ–°CPUå›¾è¡¨
                    this.charts.cpu.setOption({
                        series: [{
                            data: [{
                                value: cpuUsage,
                                itemStyle: { 
                                    color: cpuUsage > 90 ? '#dc2626' : 
                                           cpuUsage > 75 ? '#d97706' : 
                                           cpuUsage > 50 ? '#059669' : '#3b82f6' 
                                }
                            }]
                        }]
                    });
                    
                    // æ›´æ–°CPUçŠ¶æ€
                    const cpuStatusElement = document.getElementById('cpu-status');
                    if (cpuUsage > 90) {
                        cpuStatusElement.textContent = 'å±é™©';
                        cpuStatusElement.className = 'status-critical text-sm font-medium pulse-animation';
                    } else if (cpuUsage > 75) {
                        cpuStatusElement.textContent = 'è­¦å‘Š';
                        cpuStatusElement.className = 'status-warning text-sm font-medium pulse-animation';
                    } else {
                        cpuStatusElement.textContent = 'è‰¯å¥½';
                        cpuStatusElement.className = 'status-good text-sm font-medium';
                    }

                    // æ›´æ–°ç³»ç»Ÿä¿¡æ¯ï¼ˆè¿è¡Œæ—¶é—´ç­‰ï¼‰
                    const systemInfo = await this.apiClient.get('/api/system/info');
                    if (systemInfo.timestamp) {
                        const uptimeSec = Math.floor((Date.now() - systemInfo.timestamp) / 1000);
                        const days = Math.floor(uptimeSec / (24 * 3600));
                        const hours = Math.floor((uptimeSec % (24 * 3600)) / 3600);
                        const minutes = Math.floor((uptimeSec % 3600) / 60);
                        document.getElementById('system-uptime').textContent = 
                            `${days}å¤© ${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}`;
                    }

                    // æ›´æ–°ç£ç›˜ä¿¡æ¯å’Œæ€§èƒ½æ•°æ®
                    const diskInfo = await this.apiClient.get('/api/disk/info');
                    const diskPerformance = await this.apiClient.get('/api/disk/performance');
                    this.updateDiskInfo(diskInfo, diskPerformance);

                    // æ›´æ–°è¿›ç¨‹åˆ—è¡¨
                    const processes = await this.apiClient.get('/api/processes');
                    this.updateProcessList(processes);
                } catch (error) {
                    console.error('æ›´æ–°å®æ—¶æ•°æ®å¤±è´¥:', error);
                }
            }

            startRealTimeUpdates() {
                // æ¯2ç§’æ›´æ–°ä¸€æ¬¡ç£ç›˜æ•°æ®ï¼ˆå› ä¸ºç£ç›˜IOå˜åŒ–ç›¸å¯¹è¾ƒæ…¢ï¼‰
                setInterval(() => {
                    this.updateRealTimeData();
                }, 2000);
            }
        }

        // è¿›ç¨‹ç­›é€‰åŠŸèƒ½
        function filterProcesses(type) {
            // å½“å‰åç«¯APIä¸æ”¯æŒç­›é€‰ï¼Œæ‰€ä»¥æ­¤åŠŸèƒ½æš‚æ—¶ä¿ç•™å ä½
        }

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', () => {
            window.systemMonitor = new SystemMonitor();

            // å“åº”å¼å›¾è¡¨è°ƒæ•´
            window.addEventListener('resize', () => {
                if (window.systemMonitor.charts.cpu) {
                    window.systemMonitor.charts.cpu.resize();
                }
                if (window.systemMonitor.charts.memory) {
                    window.systemMonitor.charts.memory.resize();
                }
            });
        });
    </script>
</body>
</html>